# keeper.htb ðŸ±â€ðŸ‘¤
## ! need to add screenshots !

to begin, i started by running a service scan with nmap

Looks like only 2 ports are open.
80 : http
22 : ssh


OpenSSH is being used, theyâ€™re running 8.9 which is a bit outdated, maybe thereâ€™s a vuln in thereâ€¦ but let's look the nginx first.

NOTE: Add the hostname from the nmap scan (keeper.htb) to /etc/hosts

The site resolves to this. Lets add tickets.keeper.htb to our hosts as well and see where it takes usâ€¦


Tickets.keeper.htb resolves to a login portal. Looks like the site is using Best Practicalâ€™s Request Tracker 4.4.4

Perhaps we can use the default RT 4.4.4 creds to sign in?

Digging through RTâ€™s docs I found some default creds. 

root:password



Nice.

Lets see if these creds also work with SSH perhaps?

No luckâ€¦







Poking around a bit, I found some other users in Admin -> Users -> Select


Looking at the user â€˜lnorgaardâ€™ thereâ€™s some hardcoded credsâ€¦

lnorgaard:Welcome2023!

Lets try to ssh with these credentials?

Nice, successful connection and we have a user flag.







Now, to get rootâ€¦ Let's see what â€˜lnorgaardâ€™ can use as su, if anything.
Try: sudo -l

No luck.

Soooooo let's see whatâ€™s in the zip instead.
Try: less <file>


Looks juicy. Lets see if we can extract it to our host.
Try cURL, WGET, SCPâ€¦etc

I used scp in this case.
(scp <user>@<ip>:<file> ./<out-file>)

















Once extracted, we get two files â€˜KeePassDumpFull.dmpâ€™ and â€˜passcodes.kdbxâ€™
Lets see if we can extract any info from the dump?
I found the following tool on github: https://github.com/vdohney/keepass-password-dumper 
(KeePass-Password-Dumper)
For some reason this shit would not work in my Kali box because of outdated .NET sdk and it was annoying me so I copied the file to my host env, Windows 10.


After running the tool weâ€™re given the following output. This looks like gibberish or a different language?

Goog suggests perhaps thereâ€™s a small typo or missing info? Looks like â€˜dgrÃ¸d med flÃ¸deâ€™ is supposed to be â€˜rÃ¸dgrÃ¸d med flÃ¸deâ€™ which means Red Berry Pudding (possible passphrase?)







Letâ€™s see if this is the master passphrase for the keepass file. 
I installed the KeePass â€˜kpcli toolsâ€™ on my kali box to look at the file in my terminal.

Try: kpcli, then open <file> and enter the passphrase when prompted


Nice, looks like it worked lol.

I looked inside passcodes, thereâ€™s a bunch of sub-dirs and the only one with info is Network.






Quick Googling of kpcli commands, I found that the â€˜showâ€™ command lets you peer into entries.

Looks like thereâ€™s potentially some root creds in here?
root:F4><3K0nd!
Lets try to ssh with them nowâ€¦

Looks like it's not gonna work. However, we do have a PuTTy key here. PuTTy is an ssh client, so let's see if we can make our own key with this info and then try a regular ssh with it?

I made a file called â€˜keyâ€™ in the .ppk format (private-putty-key) and then from here we need to convert it to a standard ssh usable key format such as .pem, and not the putty-proprietary format for their client.

Using the puttygen utility I created the following pem file.












Now we can try to ssh using our new key.

Looks like it worked! 
We can access the root flag from here. 

Success!
